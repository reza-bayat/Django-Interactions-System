<div id="comment-{{ node.id }}" class="mb-4 p-3 border rounded-md bg-white shadow-sm">
  <div class="flex justify-between items-start">
    <div>
      <span class="font-semibold">{{ node.user.get_full_name|default:node.user.username }}</span>
      <span class="text-xs text-gray-500 ml-2">{{ node.created_at|timesince }} پیش</span>
    </div>
  </div>

  <p class="mt-2 text-gray-700 whitespace-pre-line">{{ node.content }}</p>

  <!-- دکمه پاسخ -->
  <button type="button" onclick="toggleReplyForm({{ node.id }})"
          class="mt-2 text-sm text-blue-600 hover:text-blue-800">
    پاسخ
  </button>

  <!-- فرم پاسخ -->
  <div id="reply-section-{{ node.id }}" class="hidden mt-3">
    <form hx-post="{% url 'comments:create' content_type.id object_id %}"
          hx-target="#reply-message-{{ node.id }}"
          hx-swap="innerHTML"
          hx-on:after-request="this.reset();">
      {% csrf_token %}
      <input type="hidden" name="parent_id" value="{{ node.id }}">
      <textarea name="content"
                rows="2"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"
                placeholder="پاسخ خود را بنویسید..."></textarea>
      <div class="mt-2">
        <button type="submit"
                class="px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700">
          ارسال پاسخ
        </button>
      </div>
    </form>
    <div id="reply-message-{{ node.id }}" class="mt-2"></div>
  </div>

  <!-- نمایش فرزندان -->
  {% if node.get_children %}
    <div class="mt-4 pl-4 border-l-2 border-gray-200">
      {% for child in node.get_children %}
        {% include "comments/comment_item.html" with node=child content_type=content_type object_id=object_id %}
      {% endfor %}
    </div>
  {% endif %}
</div>
